---
title: "MY WHALE SHARK REPORT"
author: "AMICA - EVAN GINTING & HARSH JAIN"
format: html
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      eval = TRUE,
                      warning = FALSE,
                      message = FALSE)
```

```{r loadLibraries}
library(tidyverse)
library(ggplot2)
library(here)
```

## Introduction

Whale Shark (Rhincodon typus) is the largest of all fishes alive. It may grow up to 18 metres (m) in length, but commonly seen between 4 m to 12 m. It is typically blue-grey or brownish in color with a pattern of white spots and vertical lines on its body. In terms of the diet, they feed on plankton, small crustaceans, squid, and fishes. The main feature of their food processing tools are their filtering screens on the gills and their tiny, more than 300 hooked teeth in both jaws. They are found on all the tropical oceans of the world where the water temperatures are ranging from 21 to 25 degrees Celsius and typically at depths of up to 1000 meters. Whale sharks are generally known to be active swimmers, and their activity can vary throughout the day and night. They do not exhibit diurnal (daytime) or seasonal (summer/winter) patterns of activity in the same way that some other species do. However, they seasonally come close to inshore areas, especially at plankton-rich locations. In Australia, it is found primarily in northern Western Australia, the Northern Territory, and Queensland. Whale sharks are known to migrate to the Ningaloo Marine park during specific times of the year, usually between March and July which is associated with the availability of plankton and other food sources in the area. During this time, there is usually a big ecotourism activity happening here for the chance to swim with them. Sadly, now, their status is an endangered species due to massive hunt of parts of their bodies. Hence, Conservation measures, including protections and regulations, are being implemented to safeguard this species in Australia and many other countries.

Expectations:

-   We expect to observe seasonal patterns in whale shark sightings, with higher occurrences during fall months.
-   We expect to see differences in the frequency of sightings between coastal areas and open ocean regions, indicating habitat preferences.
-   We expect to observe declining occurrences up to this year (2023).
-   We anticipate finding correlations between environmental factors, such as sea surface temperature and ocean currents, and the presence or absence of whale sharks in specific locations.
-   We expect to spot the most occurrences in the northern Western Australia.


## Data description

This dataset contains the information about the occurence of Whale Shark (Rhincodon Typus) in Australia at a certain time and place. The data is retrieved from the [Atlas of Living Australia (ALA) Website](https://www.ala.org.au/). ALA is a collaborative, digital, open infrastructure that pulls together Australian biodiversity data from multiple sources, making it accessible and reusable.

```{r loadData}
# Extracting the occurence data from ALA Website
library(galah) 
galah_config(email = "egin0003@student.monash.edu") 
ws_raw <- galah_call() |> 
  galah_identify("Rhincodon typus") |> 
  atlas_occurrences()

# Saving the raw data
save(ws_raw, file=here::here("data-raw/ws_raw.rda")) 
```

The data is located in folder `data-raw` named as `ws_raw.rda`. It contains these variables:

| Variables        | Description                                                                                                                                                                                     |
|------------------------------------|------------------------------------|
| decimalLongitude | The geographic longitude (in decimal degrees) of the geographic center of a Location.                                                                                                           |
| decimalLatitude  | The geographic latitude (in decimal degrees) of the geographic center of a Location.                                                                                                            |
| eventDate        | The date-time or interval during which an Event occurred. For occurrences, this is the date-time when the event was recorded. Not suitable for a time in a geological context.                  |
| scientificName   | The full scientific name, with authorship and date information if known. When forming part of an Identification, this should be the name in lowest level taxonomic rank that can be determined. |
| taxonConceptID   | The ID in an external taxonomic database, like a sequence reference database for example.                                                                                                       |
| recordID         | The ID of the occurence.                                                                                                                                                                        |
| dataResourceName | The name identifying the data set from which the record was derived.                                                                                                                            |
| occurenceStatus  | A statement about the presence or absence of a Taxon at a Location.                                                                                                                             |

```{r wildOccurences}
#| warning: false
#| message: false
#| eval: true
#| include: true

# Extracting the assertion data from ALA Website 
ws_assert <- galah_call() |>
  galah_identify("Rhincodon typus") |>
  galah_select(group = "assertions") |>
  atlas_occurrences()

# Saving the assertion data
save(ws_raw, file=here::here("data-raw/ws_assertion.rda"))


# Extracting the event data from ALA Website
ws_event <- galah_call() |>
  galah_identify("Rhincodon typus") |>
  galah_select(group = "event") |>
  atlas_occurrences()

# Saving the event data
save(ws_raw, file=here::here("data-raw/ws_event.rda"))
```


## Initial data analysis
### Data Quality Check
#### General Check
```{=html}
<!--
3. Perform a data quality check, and then go ahead and clean the data, saving only the wild sightings. Save the resulting data in a `data` folder as an `WILD_THING_COMMON_NAME.rda` file, so that any special variable types are clearly available. (Replace `WILD_THING_COMMON_NAME` with lower case common name of your assigned wild thing.) *Note:* Some are museum or historical records or live in an animal sanctuary or zoo, which do not truly capture their wild behaviour. Downloading the event information (`galah_select(group = "event")`) can help identify wild sightings.

Weather data pre-processing here too.
-->
```

- There are `r ws_raw$dataResourceName %>% n_distinct()` different data sources and upon referring their data collection method on atlas website, it is evident that all the sightings are wild sightings.
- ws_event data has the samplingProtocol variable which basically indicates what type of sighting or data collection method was used. Most of the values are missing for this variable so it is also not a reliable method to identify wild sightings.
- From ws_assert (assertion) data, we can refer to the `BASIS_OF_RECORD_INVALID` column, which provide information if the occurences are valid or invalid. Currently, there are `r ws_assert %>% filter(BASIS_OF_RECORD_INVALID == "TRUE") %>% nrow()` values recorded as TRUE indicating that they are invalid records. These invalid records will be removed to ensure the quality of the data.

#### Data Type Check
For the occurences dataset, we are going to perform some quality check, as mention below: 

```{r IDA}
library(visdat)
vis_dat(ws_raw)
# Checking data types and replacing them with correct data types
ws_raw <- ws_raw %>%
  mutate(decimalLatitude = as.numeric(decimalLatitude),
         decimalLongitude = as.numeric(decimalLongitude),
         eventDate = as.Date(eventDate))
```
From the plot above, we can see:
- The classes for all the variables in the ws_raw data set are correct except for `eventDate` which needs to be of Date type and only include dates.
- There are a few missing values for `decimalLatitude` and `decimalLongitude` . We can also see that if `decimalLatitude` is missing, `decimalLongitude` is also missing and vice-versa.
- There are `r ws_raw %>% filter(is.na(eventDate)) %>% nrow()` missing values in the `eventDate` variable out of `r ws_raw %>% nrow()` records. 

#### Outliers Check
- Checking eventDate variables:
```{r IDA2}
ws_raw %>% filter(!is.na(eventDate)) %>% ggplot(aes(y = year(eventDate))) + geom_boxplot()
```

- There are only a few outlier years out of which the year below 1980 is farthest from the population. 
- There are `r ws_raw %>% filter(year(eventDate) < 1990) %>% nrow()` rows with record year less than 1990 which will be removed as they are not really reliable.
- The other outliers might have some valid information since they follow natural order so we won't be excluding them in clean data.


### Data Cleansing and Transforming

```{r IDA3}
library(leaflet)
m <- leaflet() %>%
  addTiles() %>%
  addMarkers(data = ws_raw, lat = ~decimalLatitude, lng = ~decimalLongitude)
m
```

- When plotting the locations of whale shark spotting, it is evident that some instances are from around the world and not just Australian waters. 
- We will put identifier for occurences near coastal area and open ocean range area by looking at the map above.


## Visual Inference Analysis (EDA)

```{=html}
<!--
4. Make plots of the data to check each of your expectations, and report what you learn. *Note:* This might also be a place where visual inference methods *may* be useful to determine if what is seen agrees or disputes what you expected. 

Weather data exploration here too.
-->
```

## Summary

## References

Department of Fisheries, Government of Western Australia. (2011, September). Fisheries Fact Sheet: Whale Shark. https://www.fish.wa.gov.au/documents/recreational_fishing/fact_sheets/fact_sheet_whale_shark.pdf

McGrouther, Mark. (2022, October). Whale Shark, Rhincodon typus (Smith, 1828). Australian Museum. https://australian.museum/learn/animals/fishes/whale-shark-rhincodon-typus-smith-1828/

Britannica. (2023, August). Whale Shark. Britannica. https://www.britannica.com/animal/whale-shark
